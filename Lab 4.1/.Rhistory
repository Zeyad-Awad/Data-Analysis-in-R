sample_props_small <- global_monitor %>%
rep_sample_n(size = 10, reps = 25, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Doesn't benefit")
)
(
sample_props_small <- global_monitor %>%
rep_sample_n(size = 10, reps = 25, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Doesn't benefit")
)
(
sample_props_small <- global_monitor %>%
rep_sample_n(size = 10, reps = 25, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Doesn't benefit")
)
(
sample_props_small <- global_monitor %>%
rep_sample_n(size = 10, reps = 25, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Doesn't benefit")
)
(
sample_props_small <- global_monitor %>%
rep_sample_n(size = 10, reps = 25, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Doesn't benefit")
)
(
sample_props_small <- global_monitor %>%
rep_sample_n(size = 10, reps = 25, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Doesn't benefit")
)
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work = "Benefit")
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Benefit")
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Benefit")
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Benefit")
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
filter(scientist_work == "Benefits")
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n)) %>%
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(5000) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(5000) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(5000) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(5000) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(5000) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(5000) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(50000) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
samp15 <- global_monitor %>%
sample_n(15) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
samp15
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram()
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(bins = 30)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.2)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.02)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.03)
global_monitor %>%
count(scientist_work) %>%
mutate(p = n/sum(n)) %>%
filter(scientist_work == "Benefits")
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.02)
global_monitor %>%
count(scientist_work) %>%
mutate(p = n/sum(n)) %>%
filter(scientist_work == "Benefits")
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.01)
global_monitor %>%
count(scientist_work) %>%
mutate(p = n/sum(n)) %>%
filter(scientist_work == "Benefits")
sample_props15 <- global_monitor %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props15 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.02)
global_monitor %>%
count(scientist_work) %>%
mutate(p = n/sum(n)) %>%
filter(scientist_work == "Benefits")
sample_props150 <- global_monitor %>%
rep_sample_n(size = 150, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props150 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.02)
global_monitor %>%
count(scientist_work) %>%
mutate(p = n/sum(n)) %>%
filter(scientist_work == "Benefits")
sample_props150 <- global_monitor %>%
rep_sample_n(size = 150, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props150 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.02)
global_monitor %>%
count(scientist_work) %>%
mutate(p = n/sum(n)) %>%
filter(scientist_work == "Benefits")
sample_props150 <- global_monitor %>%
rep_sample_n(size = 150, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props150 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.01)
global_monitor %>%
count(scientist_work) %>%
mutate(p = n/sum(n)) %>%
filter(scientist_work == "Benefits")
sample_props150 <- global_monitor %>%
rep_sample_n(size = 150, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props150 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.02)
global_monitor %>%
count(scientist_work) %>%
mutate(p = n/sum(n)) %>%
filter(scientist_work == "Benefits")
sample_props150 <- global_monitor %>%
rep_sample_n(size = 150, reps = 2000, replace = TRUE) %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))%>%
filter(scientist_work == "Benefits")
sample_props150 %>%
ggplot(aes(x = p_hat)) +
geom_histogram(binwidth = 0.02)
library(tidyverse)
library(openintro)
library(infer)
set.seed(50)
global_monitor <- tibble(
scientist_work = c(rep("Benefits", 80000), rep("Doesn't benefit", 20000))
)
ggplot(global_monitor, aes(x=scientist_work))+
geom_bar()+
labs(x="",y="",
title = "Do you believe that the work scientists do benefit people like you?")+
coord_flip()
global_monitor %>%
count(scientist_work) %>%
mutate(p = n/sum(n))
samp1 <- global_monitor %>%
sample_n(50)
samp1 %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
ggplot(samp1, aes(x=scientist_work))+
geom_bar()+
labs(x="",y="",
title = "Do you believe that the work scientists do benefit people like you?")+
coord_flip()
samp2 <- global_monitor %>%
sample_n(50)
samp2 %>%
count(scientist_work) %>%
mutate(p_hat = n/sum(n))
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 15000, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 15000, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 15000, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 50, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50%>%
ggplot(aes(x = stat))+
geom_histogram(binwidth = 0.02)+
geom_vline(xintercept = median(sample_props50$p_hat), color = "white", alpha = 0.5, linetype = "dashed")+
labs(x = "p_hat (Doesn't benefit)",
title = "Sampling distribution of p_hat",
subtitle = "Sample size = 50, Number of samples = 15000")
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 50, type = "bootstrap")%>%
calculate(stat = "props")
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 50, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50%>%
ggplot(aes(x = stat))+
geom_histogram(binwidth = 0.02)
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 50, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50%>%
ggplot(aes(x = stat))+
geom_histogram()
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 50, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50%>%
ggplot(aes(x = stat))+
geom_density()
View(samp15)
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 15000, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 15000, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 150, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50%>%
ggplot(aes(x = stat))+
geom_density()
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 500, type = "bootstrap")%>%
calculate(stat = "prop")
sample_props50%>%
ggplot(aes(x = stat))+
geom_density()
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 500, type = "permute")%>%
calculate(stat = "prop")
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 100, type = "permute")%>%
calculate(stat = "prop")
sample_props50 <- global_monitor %>%
specify(response = scientist_work, success = "Doesn't benefit")%>%
generate(reps = 100)%>%
calculate(stat = "prop")
sample_props50%>%
ggplot(aes(x = stat))+
geom_density()
